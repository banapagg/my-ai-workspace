# slide-generate: 画像からPPTXスライドを自動生成

このコマンドは、チャットに提供された画像を解析してPPTXファイルを生成します。

## 引数

`$ARGUMENTS` : プレゼンのタイトル（省略可。省略時は「プレゼンテーション」）

## 実行手順

以下のステップを順番に実行してください。

### ステップ1: タイトルと画像パスの取得

1. `$ARGUMENTS` からプレゼンタイトルを取得する。空の場合は「プレゼンテーション」とする。
2. この会話で提供された画像ファイルのパスをすべてリストアップする。
   - ユーザーがドラッグ&ドロップした画像のファイルパスを使用する。
   - 画像がない場合は、画像なしでスライドを作成する旨をユーザーに伝えて続行する。

### ステップ2: 各画像を解析してスライド内容を生成

画像ごとに以下を行う：

1. 画像を**詳しく観察**する
2. 以下を日本語で生成する：
   - `title`: その画像の内容を表す簡潔なタイトル（20文字以内）
   - `body`: 画像の主要な説明（1〜2文、60文字以内）
   - `bullets`: 画像から読み取れる重要なポイント3〜5個（各20文字以内）

### ステップ3: JSONファイルを作成

以下の形式でJSONを組み立て、`tmp/slides_draft.json` に書き込む。

**重要なルール:**
- 最初のスライドは必ず `"layout": "title"` のタイトルスライドにする
- 各画像は `"layout": "image_caption"` のスライドにする
- `image_path` には実際の絶対パスを記載する

```json
{
  "title": "<$ARGUMENTSのタイトル>",
  "output_dir": "slides",
  "style": "default",
  "slides": [
    {
      "layout": "title",
      "title": "<プレゼンタイトル>",
      "subtitle": "<今日の日付 YYYY年MM月DD日>"
    },
    {
      "layout": "image_caption",
      "title": "<画像1のタイトル>",
      "body": "<画像1の説明>",
      "bullets": ["<ポイント1>", "<ポイント2>", "<ポイント3>"],
      "image_path": "<画像1の絶対パス>"
    }
  ]
}
```

`tmp/` ディレクトリが存在しない場合は `mkdir -p tmp` で作成してから書き込む。

### ステップ4: Pythonスクリプトでを実行してPPTXを生成

```bash
python3 projects/sub-agents/tools/slide_generator.py tmp/slides_draft.json
```

カレントディレクトリが `/home/user/my-ai-workspace` であることを確認してから実行する。
違う場合は絶対パスを使って実行する。

### ステップ5: 結果を報告

完了後、以下を日本語で報告する：
- 生成したPPTXファイルのパス
- 何枚のスライドを作成したか
- 使用した画像の数

## 注意事項

- 画像がない場合でも、テキストのみのスライドとして作成できる
- `image_path` が存在しないファイルを指定すると画像なしで続行する（エラーにならない）
- スタイルをカスタマイズしたい場合は `projects/sub-agents/tools/slide_style.json` を編集する
